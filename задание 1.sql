#создание базы данных
CREATE DATABASE orders;
USE orders;

#создание таблицы для загрузки справочника типов ценных бумаг
CREATE TABLE security_type
(
	id INT NOT NULL auto_increment,
    instrument_type VARCHAR(40) NOT NULL DEFAULT ' ',
    seccode VARCHAR(40) NOT NULL DEFAULT ' ',
    PRIMARY KEY (id)
);

DESCRIBE security_type;

#скрипт для наполнения справочника типов ценных бумаг через файл, который был выгружен с сайта moex.com и обработан в Excel (удалены лишние столбцы, удалены типы инструментов, которые не нужны для данного задания)
LOAD DATA
	INFILE '/Users/ekaterina/Desktop/дд/IT/ListingSecurityList.txt'
    INTO TABLE security_type
	FIELDS TERMINATED by '\t'
    LINES TERMINATED by '\r\n';

#не работает скрипт для загрузки данных из файла, выдает следующую ошибку 1290, на форумах не получилось найти решения (SHOW VARIABLES LIKE 'secure_file_priv';), поэтому пришлось вставлять данные через insert
INSERT INTO security_type VALUES
(NULL,'акция обыкновенная','ABRD'),
(NULL,'акция обыкновенная','ACKO'),
(NULL,'акция обыкновенная','AFKS'),
(NULL,'акция обыкновенная','AFLT'),
(NULL,'акция обыкновенная','AKRN'),
(NULL,'акция обыкновенная','ALBK'),
(NULL,'акция обыкновенная','ALNU'),
(NULL,'акция обыкновенная','ALRS'),
(NULL,'акция обыкновенная','AMEZ'),
(NULL,'акция обыкновенная','APTK'),
(NULL,'акция обыкновенная','AQUA'),
(NULL,'акция обыкновенная','ARMD'),
(NULL,'акция обыкновенная','ARSA'),
(NULL,'акция обыкновенная','ASSB'),
(NULL,'акция обыкновенная','AVAG'),
(NULL,'акция обыкновенная','AVAN'),
(NULL,'акция обыкновенная','AVAZ'),
(NULL,'акция привилегированная','AVAZP'),
(NULL,'акция обыкновенная','BANE'),
(NULL,'акция привилегированная','BANEP'),
(NULL,'акция обыкновенная','BELU'),
(NULL,'акция обыкновенная','BISV'),
(NULL,'акция привилегированная','BISVP'),
(NULL,'акция обыкновенная','BLNG'),
(NULL,'акция обыкновенная','BRZL'),
(NULL,'акция обыкновенная','BSPB'),
(NULL,'акция привилегированная','BSPBP'),
(NULL,'акция обыкновенная','CBOM'),
(NULL,'акция обыкновенная','CHEP'),
(NULL,'акция обыкновенная','CHGZ'),
(NULL,'акция обыкновенная','CHKZ'),
(NULL,'акция обыкновенная','CHMF'),
(NULL,'акция обыкновенная','CHMK'),
(NULL,'акция обыкновенная','CLSB');
INSERT INTO security_type VALUES
(NULL,'акция привилегированная','CLSBP'),
(NULL,'акция обыкновенная','CNTL'),
(NULL,'акция привилегированная','CNTLP'),
(NULL,'акция обыкновенная','DASB'),
(NULL,'акция обыкновенная','DIOD'),
(NULL,'акция обыкновенная','DSKY'),
(NULL,'акция обыкновенная','DVEC'),
(NULL,'акция обыкновенная','DZRD'),
(NULL,'акция привилегированная','DZRDP'),
(NULL,'акция обыкновенная','EELT'),
(NULL,'акция обыкновенная','ELTZ'),
(NULL,'акция обыкновенная','ENRU'),
(NULL,'акция обыкновенная','FEES'),
(NULL,'акция обыкновенная','FESH'),
(NULL,'акция обыкновенная','FTRE'),
(NULL,'акция обыкновенная','GAZA'),
(NULL,'акция привилегированная','GAZAP'),
(NULL,'акция обыкновенная','GAZC'),
(NULL,'акция обыкновенная','GAZP'),
(NULL,'акция обыкновенная','GAZS'),
(NULL,'акция обыкновенная','GAZT'),
(NULL,'акция обыкновенная','GCHE'),
(NULL,'акция обыкновенная','GMKN'),
(NULL,'акция обыкновенная','GRNT'),
(NULL,'акция обыкновенная','GTLC'),
(NULL,'акция обыкновенная','GTPR'),
(NULL,'акция обыкновенная','GTRK'),
(NULL,'акция обыкновенная','GTSS'),
(NULL,'акция обыкновенная','HALS'),
(NULL,'акция обыкновенная','HIMC'),
(NULL,'акция привилегированная','HIMCP'),
(NULL,'акция обыкновенная','HYDR');
INSERT INTO security_type VALUES
(NULL,'акция обыкновенная','IDVP'),
(NULL,'акция обыкновенная','IGST'),
(NULL,'акция привилегированная','IGSTP'),
(NULL,'акция обыкновенная','IRAO'),
(NULL,'акция обыкновенная','IRGZ'),
(NULL,'акция обыкновенная','IRKT'),
(NULL,'акция обыкновенная','ISKJ'),
(NULL,'акция обыкновенная','JNOS'),
(NULL,'акция привилегированная','JNOSP'),
(NULL,'акция обыкновенная','KAZT'),
(NULL,'акция привилегированная','KAZTP'),
(NULL,'акция обыкновенная','KBSB'),
(NULL,'акция обыкновенная','KBTK'),
(NULL,'акция обыкновенная','KCHE'),
(NULL,'акция привилегированная','KCHEP'),
(NULL,'акция обыкновенная','KGKC'),
(NULL,'акция привилегированная','KGKCP'),
(NULL,'акция обыкновенная','KLSB'),
(NULL,'акция обыкновенная','KMAZ'),
(NULL,'акция обыкновенная','KMEZ'),
(NULL,'акция обыкновенная','KMTZ'),
(NULL,'акция обыкновенная','KOGK'),
(NULL,'акция обыкновенная','KRKN'),
(NULL,'акция привилегированная','KRKNP'),
(NULL,'акция обыкновенная','KRKO'),
(NULL,'акция привилегированная','KRKOP'),
(NULL,'акция обыкновенная','KROT'),
(NULL,'акция привилегированная','KROTP'),
(NULL,'акция обыкновенная','KRSB'),
(NULL,'акция привилегированная','KRSBP'),
(NULL,'акция обыкновенная','KSGR'),
(NULL,'акция обыкновенная','KTSB'),
(NULL,'акция привилегированная','KTSBP'),
(NULL,'акция обыкновенная','KUBE'),
(NULL,'акция обыкновенная','KUNF');
INSERT INTO security_type VALUES
(NULL,'акция обыкновенная','KUZB'),
(NULL,'акция обыкновенная','KZMS'),
(NULL,'акция обыкновенная','KZOS'),
(NULL,'акция привилегированная','KZOSP'),
(NULL,'акция обыкновенная','LIFE'),
(NULL,'акция обыкновенная','LKOH'),
(NULL,'акция обыкновенная','LNZL'),
(NULL,'акция привилегированная','LNZLP'),
(NULL,'акция обыкновенная','LPSB'),
(NULL,'акция обыкновенная','LSNG'),
(NULL,'акция привилегированная','LSNGP'),
(NULL,'акция обыкновенная','LSRG'),
(NULL,'акция обыкновенная','LVHK'),
(NULL,'акция обыкновенная','MAGE'),
(NULL,'акция привилегированная','MAGEP'),
(NULL,'акция обыкновенная','MAGN'),
(NULL,'акция обыкновенная','MERF'),
(NULL,'акция обыкновенная','MFGS'),
(NULL,'акция привилегированная','MFGSP'),
(NULL,'акция обыкновенная','MFON'),
(NULL,'акция обыкновенная','MGNT'),
(NULL,'акция обыкновенная','MGNZ'),
(NULL,'акция обыкновенная','MGTS'),
(NULL,'акция привилегированная','MGTSP'),
(NULL,'акция обыкновенная','MGVM'),
(NULL,'акция обыкновенная','MISB'),
(NULL,'акция привилегированная','MISBP'),
(NULL,'акция обыкновенная','MNFD'),
(NULL,'акция обыкновенная','MOBB'),
(NULL,'акция обыкновенная','MOEX'),
(NULL,'акция обыкновенная','MORI'),
(NULL,'акция обыкновенная','MRKC');
INSERT INTO security_type VALUES
(NULL,'акция обыкновенная','MRKK'),
(NULL,'акция обыкновенная','MRKP'),
(NULL,'акция обыкновенная','MRKS'),
(NULL,'акция обыкновенная','MRKU'),
(NULL,'акция обыкновенная','MRKV'),
(NULL,'акция обыкновенная','MRKY'),
(NULL,'акция обыкновенная','MRKZ'),
(NULL,'акция обыкновенная','MRSB'),
(NULL,'акция обыкновенная','MSNG'),
(NULL,'акция обыкновенная','MSRS'),
(NULL,'акция обыкновенная','MSST'),
(NULL,'акция обыкновенная','MSTT'),
(NULL,'акция обыкновенная','MTLR'),
(NULL,'акция привилегированная','MTLRP'),
(NULL,'акция обыкновенная','MTSS'),
(NULL,'акция обыкновенная','MUGS'),
(NULL,'акция привилегированная','MUGSP'),
(NULL,'акция обыкновенная','MVID'),
(NULL,'акция обыкновенная','NAUK'),
(NULL,'акция обыкновенная','NFAZ'),
(NULL,'акция обыкновенная','NKHP'),
(NULL,'акция обыкновенная','NKNC'),
(NULL,'акция привилегированная','NKNCP'),
(NULL,'акция обыкновенная','NKSH'),
(NULL,'акция обыкновенная','NLMK'),
(NULL,'акция обыкновенная','NMTP'),
(NULL,'акция обыкновенная','NNSB'),
(NULL,'акция привилегированная','NNSBP'),
(NULL,'акция обыкновенная','NPOF'),
(NULL,'акция обыкновенная','NSVZ');
INSERT INTO security_type VALUES
(NULL,'акция обыкновенная','NVTK'),
(NULL,'акция обыкновенная','OBUV'),
(NULL,'акция обыкновенная','ODVA'),
(NULL,'акция обыкновенная','OGKB'),
(NULL,'акция обыкновенная','OMSH'),
(NULL,'акция привилегированная','OMZZP'),
(NULL,'акция обыкновенная','OPIN'),
(NULL,'акция обыкновенная','PAZA'),
(NULL,'акция обыкновенная','PHOR'),
(NULL,'акция обыкновенная','PIKK'),
(NULL,'акция обыкновенная','PLSM'),
(NULL,'акция обыкновенная','PLZL'),
(NULL,'акция обыкновенная','PMSB'),
(NULL,'акция привилегированная','PMSBP'),
(NULL,'акция обыкновенная','PRFN'),
(NULL,'акция обыкновенная','PRMB'),
(NULL,'акция обыкновенная','PRTK'),
(NULL,'акция обыкновенная','RASP'),
(NULL,'акция обыкновенная','RBCM'),
(NULL,'акция обыкновенная','RDRB'),
(NULL,'акция обыкновенная','RGSS'),
(NULL,'акция обыкновенная','RKKE'),
(NULL,'акция обыкновенная','RLMN'),
(NULL,'акция привилегированная','RLMNP'),
(NULL,'акция обыкновенная','RNFT'),
(NULL,'акция обыкновенная','ROLO'),
(NULL,'акция обыкновенная','ROSB'),
(NULL,'акция обыкновенная','ROSN'),
(NULL,'акция обыкновенная','ROST'),
(NULL,'акция обыкновенная','RSTI'),
(NULL,'акция привилегированная','RSTIP'),
(NULL,'акция обыкновенная','RTGZ'),
(NULL,'акция обыкновенная','RTKM'),
(NULL,'акция привилегированная','RTKMP'),
(NULL,'акция обыкновенная','RTSB'),
(NULL,'акция привилегированная','RTSBP');
INSERT INTO security_type VALUES
(NULL,'корпоративная облигация','RU000A0JQ1H3'),
(NULL,'корпоративная облигация','RU000A0JQ557'),
(NULL,'корпоративная облигация','RU000A0JQ5C5'),
(NULL,'корпоративная облигация','RU000A0JQ5Q5'),
(NULL,'корпоративная облигация','RU000A0JQ7X7'),
(NULL,'корпоративная облигация','RU000A0JQ7Z2'),
(NULL,'корпоративная облигация','RU000A0JQ8V9'),
(NULL,'корпоративная облигация','RU000A0JQAL8'),
(NULL,'корпоративная облигация','RU000A0JQAM6'),
(NULL,'корпоративная облигация','RU000A0JQCR1'),
(NULL,'корпоративная облигация','RU000A0JQK64'),
(NULL,'корпоративная облигация','RU000A0JQK72'),
(NULL,'корпоративная облигация','RU000A0JQRD9'),
(NULL,'корпоративная облигация','RU000A0JQS09'),
(NULL,'корпоративная облигация','RU000A0JQS74'),
(NULL,'корпоративная облигация','RU000A0JQXG0'),
(NULL,'корпоративная облигация','RU000A0JQXR7'),
(NULL,'корпоративная облигация','RU000A0JQY01'),
(NULL,'корпоративная облигация','RU000A0JQY35'),
(NULL,'корпоративная облигация','RU000A0JQYU9'),
(NULL,'корпоративная облигация','RU000A0JR0J0'),
(NULL,'корпоративная облигация','RU000A0JR0K8'),
(NULL,'корпоративная облигация','RU000A0JR1Y7'),
(NULL,'корпоративная облигация','RU000A0JR1Z4'),
(NULL,'корпоративная облигация','RU000A0JR209'),
(NULL,'корпоративная облигация','RU000A0JR217'),
(NULL,'корпоративная облигация','RU000A0JR3G0'),
(NULL,'корпоративная облигация','RU000A0JR3H8'),
(NULL,'корпоративная облигация','RU000A0JR3L0'),
(NULL,'корпоративная облигация','RU000A0JR3M8'),
(NULL,'корпоративная облигация','RU000A0JR4J2');
INSERT INTO security_type VALUES
(NULL,'корпоративная облигация','RU000A0JR4U9'),
(NULL,'корпоративная облигация','RU000A0JR5F7'),
(NULL,'корпоративная облигация','RU000A0JR6S8');
INSERT INTO security_type VALUES
(NULL,'корпоративная облигация','RU000A0JR878'),
(NULL,'корпоративная облигация','RU000A0JR8L9'),
(NULL,'корпоративная облигация','RU000A0JR8P0'),
(NULL,'корпоративная облигация','RU000A0JRA65'),
(NULL,'корпоративная облигация','RU000A0JRCX7'),
(NULL,'корпоративная облигация','RU000A0JRDY3'),
(NULL,'корпоративная облигация','RU000A0JREW5'),
(NULL,'корпоративная облигация','RU000A0JREX3'),
(NULL,'корпоративная облигация','RU000A0JREZ8'),
(NULL,'корпоративная облигация','RU000A0JRF11'),
(NULL,'корпоративная облигация','RU000A0JRFN1'),
(NULL,'корпоративная облигация','RU000A0JRFP6'),
(NULL,'корпоративная облигация','RU000A0JRHF3'),
(NULL,'корпоративная облигация','RU000A0JRHG1'),
(NULL,'корпоративная облигация','RU000A0JRJB8'),
(NULL,'корпоративная облигация','RU000A0JRJC6'),
(NULL,'корпоративная облигация','RU000A0JRJL7'),
(NULL,'корпоративная облигация','RU000A0JRJS2'),
(NULL,'корпоративная облигация','RU000A0JRJT0'),
(NULL,'корпоративная облигация','RU000A0JRJV6'),
(NULL,'корпоративная облигация','RU000A0JRJY0'),
(NULL,'корпоративная облигация','RU000A0JRK22'),
(NULL,'корпоративная облигация','RU000A0JRKC4'),
(NULL,'корпоративная облигация','RU000A0JRKD2'),
(NULL,'корпоративная облигация','RU000A0JRKM3'),
(NULL,'корпоративная облигация','RU000A0JRL96'),
(NULL,'корпоративная облигация','RU000A0JRLE8'),
(NULL,'корпоративная облигация','RU000A0JRMB2'),
(NULL,'корпоративная облигация','RU000A0JRMC0'),
(NULL,'корпоративная облигация','RU000A0JRMW8'),
(NULL,'корпоративная облигация','RU000A0JRSW5'),
(NULL,'корпоративная облигация','RU000A0JRSX3');
INSERT INTO security_type VALUES
(NULL,'корпоративная облигация','RU000A0JRTN2'),
(NULL,'корпоративная облигация','RU000A0JRU20'),
(NULL,'корпоративная облигация','RU000A0JRU46'),
(NULL,'корпоративная облигация','RU000A0JRUY7'),
(NULL,'корпоративная облигация','RU000A0JRV52'),
(NULL,'корпоративная облигация','RU000A0JRVN8'),
(NULL,'корпоративная облигация','RU000A0JRVU3'),
(NULL,'корпоративная облигация','RU000A0JRZK5'),
(NULL,'корпоративная облигация','RU000A0JS1A6'),
(NULL,'корпоративная облигация','RU000A0JS1B4'),
(NULL,'корпоративная облигация','RU000A0JS1F5'),
(NULL,'корпоративная облигация','RU000A0JS1J7'),
(NULL,'корпоративная облигация','RU000A0JS1S8'),
(NULL,'корпоративная облигация','RU000A0JS1W0'),
(NULL,'корпоративная облигация','RU000A0JS264'),
(NULL,'корпоративная облигация','RU000A0JS3L9'),
(NULL,'корпоративная облигация','RU000A0JS3M7'),
(NULL,'корпоративная облигация','RU000A0JS3U0'),
(NULL,'корпоративная облигация','RU000A0JS470'),
(NULL,'корпоративная облигация','RU000A0JS488'),
(NULL,'корпоративная облигация','RU000A0JS4J1'),
(NULL,'корпоративная облигация','RU000A0JS4K9'),
(NULL,'корпоративная облигация','RU000A0JS4L7'),
(NULL,'корпоративная облигация','RU000A0JS4Z7'),
(NULL,'корпоративная облигация','RU000A0JS5A7'),
(NULL,'корпоративная облигация','RU000A0JS5B5');
INSERT INTO security_type VALUES
(NULL,'корпоративная облигация','RU000A0JS5E9'),
(NULL,'корпоративная облигация','RU000A0JS5F6'),
(NULL,'корпоративная облигация','RU000A0JS5L4'),
(NULL,'корпоративная облигация','RU000A0JS5M2'),
(NULL,'корпоративная облигация','RU000A0JS5R1'),
(NULL,'корпоративная облигация','RU000A0JS603'),
(NULL,'корпоративная облигация','RU000A0JS6N8'),
(NULL,'корпоративная облигация','RU000A0JS6S7'),
(NULL,'корпоративная облигация','RU000A0JS6T5'),
(NULL,'корпоративная облигация','RU000A0JS710'),
(NULL,'корпоративная облигация','RU000A0JS793'),
(NULL,'корпоративная облигация','RU000A0JS7H8'),
(NULL,'корпоративная облигация','RU000A0JS8R5'),
(NULL,'корпоративная облигация','RU000A0JS9X1'),
(NULL,'корпоративная облигация','RU000A0JSGV0'),
(NULL,'корпоративная облигация','RU000A0JSKJ7'),
(NULL,'корпоративная облигация','RU000A0JSL87'),
(NULL,'корпоративная облигация','RU000A0JSQ58'),
(NULL,'корпоративная облигация','RU000A0JSZF3'),
(NULL,'корпоративная облигация','RU000A0JSZG1'),
(NULL,'корпоративная облигация','RU000A0JT1B3'),
(NULL,'корпоративная облигация','RU000A0JT2K2'),
(NULL,'корпоративная облигация','RU000A0JT3J2'),
(NULL,'корпоративная облигация','RU000A0JT403'),
(NULL,'корпоративная облигация','RU000A0JT593'),
(NULL,'корпоративная облигация','RU000A0JT6B2'),
(NULL,'корпоративная облигация','RU000A0JT6G1'),
(NULL,'корпоративная облигация','RU000A0JT6J5'),
(NULL,'корпоративная облигация','RU000A0JT7M7'),
(NULL,'корпоративная облигация','RU000A0JT7T2'),
(NULL,'корпоративная облигация','RU000A0JT874'),
(NULL,'корпоративная облигация','RU000A0JT8R4'),
(NULL,'корпоративная облигация','RU000A0JT8T0');
INSERT INTO security_type VALUES
(NULL,'корпоративная облигация','RU000A0JT940'),
(NULL,'корпоративная облигация','RU000A0JT965'),
(NULL,'корпоративная облигация','RU000A0JTB96'),
(NULL,'корпоративная облигация','RU000A0JTCV7'),
(NULL,'корпоративная облигация','RU000A0JTD37'),
(NULL,'корпоративная облигация','RU000A0JTD52'),
(NULL,'корпоративная облигация','RU000A0JTDX1'),
(NULL,'корпоративная облигация','RU000A0JTER1'),
(NULL,'корпоративная облигация','RU000A0JTFB2'),
(NULL,'корпоративная облигация','RU000A0JTH82'),
(NULL,'корпоративная облигация','RU000A0JTHF9'),
(NULL,'корпоративная облигация','RU000A0JTKA4'),
(NULL,'корпоративная облигация','RU000A0JTLJ3'),
(NULL,'корпоративная облигация','RU000A0JTLL9'),
(NULL,'корпоративная облигация','RU000A0JTM28'),
(NULL,'корпоративная облигация','RU000A0JTM36'),
(NULL,'корпоративная облигация','RU000A0JTM44'),
(NULL,'корпоративная облигация','RU000A0JTM51'),
(NULL,'корпоративная облигация','RU000A0JTMG7'),
(NULL,'корпоративная облигация','RU000A0JTMK9'),
(NULL,'корпоративная облигация','RU000A0JTPG0'),
(NULL,'корпоративная облигация','RU000A0JTQB9'),
(NULL,'корпоративная облигация','RU000A0JTR72'),
(NULL,'корпоративная облигация','RU000A0JTR80'),
(NULL,'корпоративная облигация','RU000A0JTS06'),
(NULL,'корпоративная облигация','RU000A0JTS22'),
(NULL,'корпоративная облигация','RU000A0JTT13'),
(NULL,'корпоративная облигация','RU000A0JTTV1'),
(NULL,'корпоративная облигация','RU000A0JTU85'),
(NULL,'корпоративная облигация','RU000A0JTVJ2'),
(NULL,'корпоративная облигация','RU000A0JTW83'),
(NULL,'корпоративная облигация','RU000A0JTWT9'),
(NULL,'корпоративная облигация','RU000A0JTX09'),
(NULL,'корпоративная облигация','RU000A0JTXP5');
INSERT INTO security_type VALUES
(NULL,'корпоративная облигация','RU000A0JTXQ3'),
(NULL,'корпоративная облигация','RU000A0JTYJ6'),
(NULL,'корпоративная облигация','RU000A0JTYK4'),
(NULL,'корпоративная облигация','RU000A0JTYL2'),
(NULL,'корпоративная облигация','RU000A0JTYM0'),
(NULL,'корпоративная облигация','RU000A0JTYN8'),
(NULL,'корпоративная облигация','RU000A0JTZ49'),
(NULL,'корпоративная облигация','RU000A0JTZ98'),
(NULL,'корпоративная облигация','RU000A0JTZF1'),
(NULL,'корпоративная облигация','RU000A0JTZG9'),
(NULL,'корпоративная облигация','RU000A0JU179'),
(NULL,'корпоративная облигация','RU000A0JU1Q8'),
(NULL,'корпоративная облигация','RU000A0JU278'),
(NULL,'корпоративная облигация','RU000A0JU2K9'),
(NULL,'корпоративная облигация','RU000A0JU2L7'),
(NULL,'корпоративная облигация','RU000A0JU2N3'),
(NULL,'корпоративная облигация','RU000A0JU336'),
(NULL,'корпоративная облигация','RU000A0JU3J9'),
(NULL,'корпоративная облигация','RU000A0JU6A1'),
(NULL,'корпоративная облигация','RU000A0JU716'),
(NULL,'корпоративная облигация','RU000A0JU7S1'),
(NULL,'корпоративная облигация','RU000A0JU807'),
(NULL,'корпоративная облигация','RU000A0JU872'),
(NULL,'корпоративная облигация','RU000A0JU9K4'),
(NULL,'корпоративная облигация','RU000A0JUAD7'),
(NULL,'корпоративная облигация','RU000A0JUAH8'),
(NULL,'корпоративная облигация','RU000A0JUBA1'),
(NULL,'корпоративная облигация','RU000A0JUBD5'),
(NULL,'корпоративная облигация','RU000A0JUBT1'),
(NULL,'корпоративная облигация','RU000A0JUC19'),
(NULL,'корпоративная облигация','RU000A0JUC92'),
(NULL,'корпоративная облигация','RU000A0JUCA9'),
(NULL,'корпоративная облигация','RU000A0JUCH4');
INSERT INTO security_type VALUES
(NULL,'корпоративная облигация','RU000A0JUCJ0'),
(NULL,'корпоративная облигация','RU000A0JUCX1'),
(NULL,'корпоративная облигация','RU000A0JUD00'),
(NULL,'корпоративная облигация','RU000A0JUD34'),
(NULL,'корпоративная облигация','RU000A0JUDW1'),
(NULL,'корпоративная облигация','RU000A0JUDX9'),
(NULL,'корпоративная облигация','RU000A0JUE66'),
(NULL,'корпоративная облигация','RU000A0JUFE4'),
(NULL,'корпоративная облигация','RU000A0JUFF1'),
(NULL,'корпоративная облигация','RU000A0JUFG9'),
(NULL,'корпоративная облигация','RU000A0JUFH7'),
(NULL,'корпоративная облигация','RU000A0JUG15'),
(NULL,'корпоративная облигация','RU000A0JUH89'),
(NULL,'корпоративная облигация','RU000A0JUH97'),
(NULL,'корпоративная облигация','RU000A0JUHV4'),
(NULL,'корпоративная облигация','RU000A0JUHY8'),
(NULL,'корпоративная облигация','RU000A0JUJ87'),
(NULL,'корпоративная облигация','RU000A0JUJE6'),
(NULL,'корпоративная облигация','RU000A0JUJG1'),
(NULL,'корпоративная облигация','RU000A0JUJP2'),
(NULL,'корпоративная облигация','RU000A0JUJW8'),
(NULL,'корпоративная облигация','RU000A0JUKX4'),
(NULL,'корпоративная облигация','RU000A0JUNU4'),
(NULL,'корпоративная облигация','RU000A0JUP63'),
(NULL,'корпоративная облигация','RU000A0JUPF0'),
(NULL,'корпоративная облигация','RU000A0JUPS3'),
(NULL,'корпоративная облигация','RU000A0JUPT1'),
(NULL,'корпоративная облигация','RU000A0JUPU9'),
(NULL,'корпоративная облигация','RU000A0JUQ13'),
(NULL,'корпоративная облигация','RU000A0JUQ54'),
(NULL,'корпоративная облигация','RU000A0JUQN2'),
(NULL,'корпоративная облигация','RU000A0JUQW3'),
(NULL,'корпоративная облигация','RU000A0JURP5'),
(NULL,'корпоративная облигация','RU000A0JURQ3'),
(NULL,'корпоративная облигация','RU000A0JURT7');
INSERT INTO security_type VALUES
(NULL,'корпоративная облигация','RU000A0JUT69'),
(NULL,'корпоративная облигация','RU000A0JUTC9'),
(NULL,'корпоративная облигация','RU000A0JUUB9'),
(NULL,'корпоративная облигация','RU000A0JUV57'),
(NULL,'корпоративная облигация','RU000A0JUV81'),
(NULL,'корпоративная облигация','RU000A0JUVT9'),
(NULL,'корпоративная облигация','RU000A0JUW23'),
(NULL,'корпоративная облигация','RU000A0JUZN3'),
(NULL,'корпоративная облигация','RU000A0JUZU8'),
(NULL,'корпоративная облигация','RU000A0JV0T3'),
(NULL,'корпоративная облигация','RU000A0JV102'),
(NULL,'корпоративная облигация','RU000A0JV169'),
(NULL,'корпоративная облигация','RU000A0JV185'),
(NULL,'корпоративная облигация','RU000A0JV1B9'),
(NULL,'корпоративная облигация','RU000A0JV1C7'),
(NULL,'корпоративная облигация','RU000A0JV1E3'),
(NULL,'корпоративная облигация','RU000A0JV1F0'),
(NULL,'корпоративная облигация','RU000A0JV1H6'),
(NULL,'корпоративная облигация','RU000A0JV1N4'),
(NULL,'корпоративная облигация','RU000A0JV1U9'),
(NULL,'корпоративная облигация','RU000A0JV1V7'),
(NULL,'корпоративная облигация','RU000A0JV2B7'),
(NULL,'корпоративная облигация','RU000A0JV2C5'),
(NULL,'корпоративная облигация','RU000A0JV2K8'),
(NULL,'корпоративная облигация','RU000A0JV2L6'),
(NULL,'корпоративная облигация','RU000A0JV318'),
(NULL,'корпоративная облигация','RU000A0JV326'),
(NULL,'корпоративная облигация','RU000A0JV3S9'),
(NULL,'корпоративная облигация','RU000A0JV3T7'),
(NULL,'корпоративная облигация','RU000A0JV3U5'),
(NULL,'корпоративная облигация','RU000A0JV409'),
(NULL,'корпоративная облигация','RU000A0JV4R9'),
(NULL,'корпоративная облигация','RU000A0JV508'),
(NULL,'корпоративная облигация','RU000A0JV664');
INSERT INTO security_type VALUES
(NULL,'корпоративная облигация','RU000A0JV755'),
(NULL,'корпоративная облигация','RU000A0JV7G5'),
(NULL,'корпоративная облигация','RU000A0JVAJ2'),
(NULL,'корпоративная облигация','RU000A0JVAQ7'),
(NULL,'корпоративная облигация','RU000A0JVB19'),
(NULL,'корпоративная облигация','RU000A0JVB27'),
(NULL,'корпоративная облигация','RU000A0JVB35'),
(NULL,'корпоративная облигация','RU000A0JVC42'),
(NULL,'корпоративная облигация','RU000A0JVCB5'),
(NULL,'корпоративная облигация','RU000A0JVCL4'),
(NULL,'корпоративная облигация','RU000A0JVD25'),
(NULL,'корпоративная облигация','RU000A0JVDD9'),
(NULL,'корпоративная облигация','RU000A0JVE40'),
(NULL,'корпоративная облигация','RU000A0JVE57'),
(NULL,'корпоративная облигация','RU000A0JVE65'),
(NULL,'корпоративная облигация','RU000A0JVED7'),
(NULL,'корпоративная облигация','RU000A0JVF98'),
(NULL,'корпоративная облигация','RU000A0JVFE2'),
(NULL,'корпоративная облигация','RU000A0JVFN3'),
(NULL,'корпоративная облигация','RU000A0JVHJ7'),
(NULL,'корпоративная облигация','RU000A0JVJY2'),
(NULL,'корпоративная облигация','RU000A0JVKH5'),
(NULL,'корпоративная облигация','RU000A0JVKK9'),
(NULL,'корпоративная облигация','RU000A0JVLA8'),
(NULL,'корпоративная облигация','RU000A0JVN56'),
(NULL,'корпоративная облигация','RU000A0JVN64'),
(NULL,'корпоративная облигация','RU000A0JVN98'),
(NULL,'корпоративная облигация','RU000A0JVNC0'),
(NULL,'корпоративная облигация','RU000A0JVP39'),
(NULL,'корпоративная облигация','RU000A0JVQX9'),
(NULL,'корпоративная облигация','RU000A0JVQY7'),
(NULL,'корпоративная облигация','RU000A0JVSG0'),
(NULL,'корпоративная облигация','RU000A0JVT43'),
(NULL,'корпоративная облигация','RU000A0JVTM6'),
(NULL,'корпоративная облигация','RU000A0JVTQ7'),
(NULL,'корпоративная облигация','RU000A0JVU81');
INSERT INTO security_type VALUES
(NULL,'корпоративная облигация','RU000A0JVUG6'),
(NULL,'корпоративная облигация','RU000A0JVUL6'),
(NULL,'корпоративная облигация','RU000A0JVVA7'),
(NULL,'корпоративная облигация','RU000A0JVW22'),
(NULL,'корпоративная облигация','RU000A0JVWL2'),
(NULL,'корпоративная облигация','RU000A0JVWT5'),
(NULL,'корпоративная облигация','RU000A0JVY04'),
(NULL,'корпоративная облигация','RU000A0JVYG8'),
(NULL,'корпоративная облигация','RU000A0JVZB6'),
(NULL,'корпоративная облигация','RU000A0JVZF7'),
(NULL,'корпоративная облигация','RU000A0JVZG5'),
(NULL,'корпоративная облигация','RU000A0JVZJ9'),
(NULL,'корпоративная облигация','RU000A0JW0S4'),
(NULL,'корпоративная облигация','RU000A0JW118'),
(NULL,'корпоративная облигация','RU000A0JW1G7'),
(NULL,'корпоративная облигация','RU000A0JW1V6'),
(NULL,'корпоративная облигация','RU000A0JW1Z7'),
(NULL,'корпоративная облигация','RU000A0JW2T8'),
(NULL,'корпоративная облигация','RU000A0JW316'),
(NULL,'корпоративная облигация','RU000A0JW5E3'),
(NULL,'корпоративная облигация','RU000A0JW5K0'),
(NULL,'корпоративная облигация','RU000A0JW8G2'),
(NULL,'корпоративная облигация','RU000A0JWA92'),
(NULL,'корпоративная облигация','RU000A0JWAT9'),
(NULL,'корпоративная облигация','RU000A0JWB59'),
(NULL,'корпоративная облигация','RU000A0JWBA7'),
(NULL,'корпоративная облигация','RU000A0JWBK6'),
(NULL,'корпоративная облигация','RU000A0JWBN0'),
(NULL,'корпоративная облигация','RU000A0JWBP5'),
(NULL,'корпоративная облигация','RU000A0JWC25'),
(NULL,'корпоративная облигация','RU000A0JWDA3'),
(NULL,'корпоративная облигация','RU000A0JWDB1'),
(NULL,'корпоративная облигация','RU000A0JWDC9');
INSERT INTO security_type VALUES
(NULL,'корпоративная облигация','RU000A0JWF30'),
(NULL,'корпоративная облигация','RU000A0JWF71'),
(NULL,'корпоративная облигация','RU000A0JWGW0'),
(NULL,'корпоративная облигация','RU000A0JWJQ6'),
(NULL,'корпоративная облигация','RU000A0JWK58'),
(NULL,'корпоративная облигация','RU000A0JWK74'),
(NULL,'корпоративная облигация','RU000A0JWKL5'),
(NULL,'корпоративная облигация','RU000A0JWKN1'),
(NULL,'корпоративная облигация','RU000A0JWKP6'),
(NULL,'корпоративная облигация','RU000A0JWKQ4'),
(NULL,'корпоративная облигация','RU000A0JWKY8'),
(NULL,'корпоративная облигация','RU000A0JWLE8'),
(NULL,'корпоративная облигация','RU000A0JWLU4'),
(NULL,'корпоративная облигация','RU000A0JWLY6'),
(NULL,'корпоративная облигация','RU000A0JWM49'),
(NULL,'корпоративная облигация','RU000A0JWMJ5'),
(NULL,'корпоративная облигация','RU000A0JWMT4'),
(NULL,'корпоративная облигация','RU000A0JWMZ1'),
(NULL,'корпоративная облигация','RU000A0JWN22'),
(NULL,'корпоративная облигация','RU000A0JWN63'),
(NULL,'корпоративная облигация','RU000A0JWN89'),
(NULL,'корпоративная облигация','RU000A0JWNV8'),
(NULL,'корпоративная облигация','RU000A0JWQ45'),
(NULL,'корпоративная облигация','RU000A0JWTJ0'),
(NULL,'корпоративная облигация','RU000A0JWU23'),
(NULL,'корпоративная облигация','RU000A0JWU31'),
(NULL,'корпоративная облигация','RU000A0JWU72'),
(NULL,'корпоративная облигация','RU000A0JWU80'),
(NULL,'корпоративная облигация','RU000A0JWV63'),
(NULL,'корпоративная облигация','RU000A0JWVB3'),
(NULL,'корпоративная облигация','RU000A0JWWX5'),
(NULL,'корпоративная облигация','RU000A0JWX79'),
(NULL,'корпоративная облигация','RU000A0JWYJ0'),
(NULL,'корпоративная облигация','RU000A0JWZT6'),
(NULL,'корпоративная облигация','RU000A0JX0L8'),
(NULL,'корпоративная облигация','RU000A0JX1C5'),
(NULL,'корпоративная облигация','RU000A0JX1S1');
INSERT INTO security_type VALUES
(NULL,'корпоративная облигация','RU000A0JX1T9'),
(NULL,'корпоративная облигация','RU000A0JX2B5'),
(NULL,'корпоративная облигация','RU000A0JX3M0'),
(NULL,'корпоративная облигация','RU000A0JXFC2'),
(NULL,'корпоративная облигация','RU000A0JXJM3'),
(NULL,'корпоративная облигация','RU000A0JXJP6'),
(NULL,'корпоративная облигация','RU000A0JXKQ2'),
(NULL,'корпоративная облигация','RU000A0JXLU2'),
(NULL,'корпоративная облигация','RU000A0JXM22'),
(NULL,'корпоративная облигация','RU000A0JXMB0'),
(NULL,'корпоративная облигация','RU000A0JXN62'),
(NULL,'корпоративная облигация','RU000A0JXP29'),
(NULL,'корпоративная облигация','RU000A0JXPT5'),
(NULL,'корпоративная облигация','RU000A0JXQQ9'),
(NULL,'корпоративная облигация','RU000A0JXQU1'),
(NULL,'корпоративная облигация','RU000A0JXRM6'),
(NULL,'корпоративная облигация','RU000A0JXS26'),
(NULL,'корпоративная облигация','RU000A0JXS34'),
(NULL,'корпоративная облигация','RU000A0JXU89'),
(NULL,'корпоративная облигация','RU000A0ZYBA9'),
(NULL,'корпоративная облигация','RU000A0ZYH51'),
(NULL,'корпоративная облигация','RU000A0ZYHP4'),
(NULL,'корпоративная облигация','RU000A0ZYHU4'),
(NULL,'корпоративная облигация','RU000A0ZYJ26'),
(NULL,'корпоративная облигация','RU000A0ZYJT2'),
(NULL,'корпоративная облигация','RU000A0ZYL89'),
(NULL,'корпоративная облигация','RU000A0ZYLX0'),
(NULL,'корпоративная облигация','RU000A0ZYMD0'),
(NULL,'корпоративная облигация','RU000A0ZYMF5'),
(NULL,'корпоративная облигация','RU000A0ZYPB7'),
(NULL,'корпоративная облигация','RU000A0ZYWZ2'),
(NULL,'корпоративная облигация','RU000A0ZYX28'),
(NULL,'корпоративная облигация','RU000A0ZZ4T1'),
(NULL,'корпоративная облигация','RU000A0ZZ4Z8'),
(NULL,'корпоративная облигация','RU000A0ZZ505');
INSERT INTO security_type VALUES
(NULL,'корпоративная облигация','RU000A0ZZ6K5'),
(NULL,'корпоративная облигация','RU000A0ZZ7G1'),
(NULL,'корпоративная облигация','RU000A0ZZ7H9'),
(NULL,'корпоративная облигация','RU000A0ZZ877'),
(NULL,'корпоративная облигация','RU000A0ZZ885'),
(NULL,'корпоративная облигация','RU000A0ZZ893'),
(NULL,'корпоративная облигация','RU000A0ZZC22'),
(NULL,'корпоративная облигация','RU000A0ZZCH9'),
(NULL,'корпоративная облигация','RU000A0ZZE87'),
(NULL,'корпоративная облигация','RU000A0ZZFZ4'),
(NULL,'корпоративная облигация','RU000A0ZZNW5'),
(NULL,'корпоративная облигация','RU000A0ZZR58'),
(NULL,'акция обыкновенная','RUGR'),
(NULL,'акция обыкновенная','RUSI'),
(NULL,'акция обыкновенная','RUSP'),
(NULL,'акция обыкновенная','RZSB'),
(NULL,'акция обыкновенная','SAGO'),
(NULL,'акция привилегированная','SAGOP'),
(NULL,'акция обыкновенная','SARE'),
(NULL,'акция привилегированная','SAREP'),
(NULL,'акция обыкновенная','SBER'),
(NULL,'акция привилегированная','SBERP'),
(NULL,'акция обыкновенная','SELG'),
(NULL,'акция привилегированная','SELGP'),
(NULL,'акция обыкновенная','SFIN'),
(NULL,'акция обыкновенная','SIBG'),
(NULL,'акция обыкновенная','SIBN'),
(NULL,'акция обыкновенная','SLEN'),
(NULL,'акция обыкновенная','SNGS'),
(NULL,'акция привилегированная','SNGSP'),
(NULL,'акция обыкновенная','STSB'),
(NULL,'акция привилегированная','STSBP'),
(NULL,'акция обыкновенная','SVAV');
INSERT INTO security_type VALUES
(NULL,'акция обыкновенная','SZPR'),
(NULL,'акция обыкновенная','TANL'),
(NULL,'акция привилегированная','TANLP'),
(NULL,'акция обыкновенная','TASB'),
(NULL,'акция привилегированная','TASBP'),
(NULL,'акция обыкновенная','TATN'),
(NULL,'акция привилегированная','TATNP'),
(NULL,'акция обыкновенная','TGKA'),
(NULL,'акция обыкновенная','TGKB'),
(NULL,'акция привилегированная','TGKBP'),
(NULL,'акция обыкновенная','TGKD'),
(NULL,'акция привилегированная','TGKDP'),
(NULL,'акция обыкновенная','TGKN'),
(NULL,'акция обыкновенная','TGKO'),
(NULL,'акция обыкновенная','TNSE'),
(NULL,'акция обыкновенная','TORS'),
(NULL,'акция привилегированная','TORSP'),
(NULL,'акция обыкновенная','TRCN'),
(NULL,'акция обыкновенная','TRFM'),
(NULL,'акция обыкновенная','TRMK'),
(NULL,'акция привилегированная','TRNFP'),
(NULL,'акция обыкновенная','TTLK'),
(NULL,'акция обыкновенная','TUCH'),
(NULL,'акция обыкновенная','TUZA'),
(NULL,'акция обыкновенная','UCSS'),
(NULL,'акция обыкновенная','UKUZ'),
(NULL,'акция обыкновенная','UNAC'),
(NULL,'акция обыкновенная','UNKL'),
(NULL,'акция обыкновенная','UPRO'),
(NULL,'акция обыкновенная','URKA'),
(NULL,'акция обыкновенная','URKZ'),
(NULL,'акция обыкновенная','USBN');
INSERT INTO security_type VALUES
(NULL,'акция обыкновенная','UTAR'),
(NULL,'акция обыкновенная','UTSY'),
(NULL,'акция обыкновенная','UWGN'),
(NULL,'акция обыкновенная','VDSB'),
(NULL,'акция обыкновенная','VGSB'),
(NULL,'акция привилегированная','VGSBP'),
(NULL,'акция обыкновенная','VJGZ'),
(NULL,'акция привилегированная','VJGZP'),
(NULL,'акция обыкновенная','VLHZ'),
(NULL,'акция обыкновенная','VRSB'),
(NULL,'акция привилегированная','VRSBP'),
(NULL,'акция обыкновенная','VSMO'),
(NULL,'акция обыкновенная','VSYD'),
(NULL,'акция привилегированная','VSYDP'),
(NULL,'акция обыкновенная','VTBR'),
(NULL,'акция обыкновенная','VTRS'),
(NULL,'акция обыкновенная','VZRZ'),
(NULL,'акция привилегированная','VZRZP'),
(NULL,'акция обыкновенная','WTCM'),
(NULL,'акция привилегированная','WTCMP'),
(NULL,'акция обыкновенная','YAKG'),
(NULL,'акция обыкновенная','YKEN'),
(NULL,'акция привилегированная','YKENP'),
(NULL,'акция обыкновенная','YRSB'),
(NULL,'акция привилегированная','YRSBP'),
(NULL,'акция обыкновенная','ZILL'),
(NULL,'акция обыкновенная','ZMZN'),
(NULL,'акция привилегированная','ZMZNP'),
(NULL,'акция обыкновенная','ZVEZ');

#создание таблицы для первичной загрузки данных из orderlog
CREATE TABLE orders (
    id BIGINT NOT NULL,
    seccode VARCHAR(40) NOT NULL DEFAULT ' ',
    buysell CHAR(1) NOT NULL DEFAULT ' ',
    ordertime INT NOT NULL,
    orderno BIGINT NOT NULL,
    orderstatus INT NOT NULL,
    price FLOAT NOT NULL,
    volume INT NOT NULL,
    tradeno BIGINT,
    tradeprice FLOAT,
    PRIMARY KEY (id)
);

DESCRIBE orders;

INSERT INTO orders VALUES ('1','PLSM','S','100000000','1','1','0.32','36000',NULL, NULL),
('2','ALRS','S','100000000','2','1','67.75','300',NULL,NULL),
('3','VTGK','B','100000000','3','1','0.66','15000',NULL,NULL),
('4','VTGK','B','100000000','4','1','0.655','20000',NULL,NULL),
('5','PLSM','S','100000000','5','1','0.32','136000',NULL,NULL),
('6','MGNT','B','100001085','10118','2','12250','8','2516557127','12250'),
('7','MGNT','S','100001085','10046','2','12250','8','2516557127','12250'),
('8','SBERP','S','100002450','11848','1','54.5','8300',NULL,NULL),
('9','RU000A0JXP29','S','100016026','28310','1','0','2620',NULL,NULL),
('10','RU000A0JXP29','S','100016026','28310','0','0','2620',NULL,NULL);

#удаляем из orderlog первую строчку, где содержатся биржевые названия полей
DELETE FROM orders
	ORDER BY id ASC
    LIMIT 1;

 #создание таблицы для загрузки в нее данных из orderlog по заявкам по обыкновенным акциям
 CREATE TABLE orders_ordinary_shares
 (
	id BIGINT NOT NULL,
    seccode VARCHAR(40) NOT NULL DEFAULT ' ',
    buysell CHAR(1) NOT NULL DEFAULT ' ',
    ordertime INT NOT NULL,
    orderno BIGINT NOT NULL,
    orderstatus INT NOT NULL,
    price FLOAT NOT NULL,
    volume INT NOT NULL,
    tradeno BIGINT,
    tradeprice FLOAT,
    PRIMARY KEY (id)
);

#создание таблицы для загрузки в нее данных из orderlog по заявкам по привилегированным акциям
CREATE TABLE orders_preference_shares
 (
	id BIGINT NOT NULL,
    seccode VARCHAR(40) NOT NULL DEFAULT ' ',
    buysell CHAR(1) NOT NULL DEFAULT ' ',
    ordertime INT NOT NULL,
    orderno BIGINT NOT NULL,
    orderstatus INT NOT NULL,
    price FLOAT NOT NULL,
    volume INT NOT NULL,
    tradeno BIGINT,
    tradeprice FLOAT,
    PRIMARY KEY (id)
);
#создание таблицы для загрузки данных из orderlog по заявкам по облигациям
CREATE TABLE orders_bonds
 (
	id BIGINT NOT NULL,
    seccode VARCHAR(40) NOT NULL DEFAULT ' ',
    buysell CHAR(1) NOT NULL DEFAULT ' ',
    ordertime INT NOT NULL,
    orderno BIGINT NOT NULL,
    orderstatus INT NOT NULL,
    price FLOAT NOT NULL,
    volume INT NOT NULL,
    tradeno BIGINT,
    tradeprice FLOAT,
    PRIMARY KEY (id)
);

SELECT * FROM orders
SELECT * FROM security_type

#заполнение таблицы заявок по обыкновенным акциям на основе orderlog и справочника типов инструментов
INSERT INTO orders_ordinary_shares
SELECT a1.*
FROM orders a1
	JOIN security_type a2
	ON a1.seccode = a2.seccode
WHERE a2. instrument_type = 'акция обыкновенная';

SELECT * FROM orders_ordinary_shares

 #заполнение таблицы заявок по привилегированным облигациям на основе orderlog и справочника типов инструментов
INSERT INTO orders_preference_shares
SELECT a1.*
FROM orders a1
	JOIN security_type a2
	ON a1.seccode = a2.seccode
WHERE a2. instrument_type = 'акция привилегированная';

SELECT * FROM orders_preference_shares

#заполнение таблицы заявок по корпоративным облигациям на основе orderlog и справочника типов инструментов
INSERT INTO orders_bonds
SELECT a1.*
FROM orders a1
	JOIN security_type a2
	ON a1.seccode = a2.seccode
WHERE a2. instrument_type = 'корпоративная облигация';

SELECT * FROM orders_bonds

#проверка на наличие в orderlog инструментов, которые не указаны в справочнике. В случае отсутствия данных по типу одного из инструментов, в правом столбце таблицы будет выведено NULL
SELECT a1.seccode, a2.instrument_type
	FROM orders a1
    LEFT OUTER JOIN security_type a2
    ON a1.seccode=a2.seccode
    ORDER BY a1.seccode
    
#поиск инструмента, по которому было совершено наибольшее количество сделок (первый в списке)
SELECT seccode, orderno, COUNT(*) 
	FROM orders_ordinary_shares
    WHERE tradeno IS NOT NULL 
    GROUP BY seccode, orderno
    ORDER BY COUNT(*) DESC